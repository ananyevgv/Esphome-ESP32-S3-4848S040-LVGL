esphome:
  on_boot:
    - delay: 5s
    - lvgl.slider.update:
        id: dimmer_slider
        value: !lambda return id(backlight).remote_values.get_brightness() * 100;

#-------------------------------------------
# LIGHTS
#-------------------------------------------
#light:
#  - id: !extend backlight
#    on_state:
#      - lvgl.slider.update:
#          id: dimmer_slider
#          value: !lambda return id(backlight).remote_values.get_brightness() * 100;

#-------------------------------------------
# SELECT
#-------------------------------------------
select:
  - platform: template
    name: "Screen timeout"
    id: timeout
    entity_category: config
    options:
     - "30c"    
     - "45c"   
     - "60c"
     - "90c"
     - "120c"
     - "180c"
     - "300c"
     - "600c"
    initial_option: "30c"
    optimistic: true
    icon: mdi:archive-clock-outline
    on_value:
      then:
        - lambda: |-
            switch(i) {
              case 0: id(lv_timeout) = (30000); break;
              case 1: id(lv_timeout) = (45000); break;
              case 2: id(lv_timeout) = (60000); break;
              case 3: id(lv_timeout) = (90000); break;
              case 4: id(lv_timeout) = (120000); break;
              case 5: id(lv_timeout) = (180000); break;
              case 6: id(lv_timeout) = (300000); break;
              case 7: id(lv_timeout) = (600000); break;
            }
        - lvgl.roller.update:
            id: display_timeout_roller
            selected_index: !lambda |-  
              return i;

#-------------------------------------------
# LVGL
#-------------------------------------------
lvgl:
  on_idle:
    timeout: !lambda "return id(lv_timeout);"
    then:
      - light.turn_off: backlight
      - lvgl.pause:
      
  pages:  # PAGE SETTINGS
  - id: settings_page
    bg_color: color_black
    widgets:
      - obj:
          bg_opa: TRANSP
          border_opa: TRANSP
          shadow_opa: TRANSP
          pad_all: 0
          width: 480
          height: 450
          align: TOP_MID
          layout:
            pad_column: 0
            pad_row: 0
            type: GRID
            grid_columns: [FR(10), FR(45), FR(45)]
            grid_rows: [FR(1), FR(1), FR(1), FR(1), FR(1), FR(1)]
          widgets:
            - label:
                grid_cell_column_pos: 1 # place the widget in
                grid_cell_row_pos: 0 # the corresponding cell
                grid_cell_x_align: SPACE_AROUND   #'START', 'CENTER', 'END', 'STRETCH', 'SPACE_EVENLY', 'SPACE_AROUND', 'SPACE_BETWEEN'.
                grid_cell_y_align: CENTER   #'START', 'CENTER', 'END', 'STRETCH', 'SPACE_EVENLY', 'SPACE_AROUND', 'SPACE_BETWEEN'.
                align: LEFT_MID
                text_font: roboto24
                text_color: color_amber
                text: "Яркость экрана"
                
            - slider:
                grid_cell_column_pos: 2 # place the widget in
                grid_cell_row_pos: 0 # the corresponding cell
                grid_cell_x_align: SPACE_AROUND   #'START', 'CENTER', 'END', 'STRETCH', 'SPACE_EVENLY', 'SPACE_AROUND', 'SPACE_BETWEEN'.
                grid_cell_y_align: CENTER   #'START', 'CENTER', 'END', 'STRETCH', 'SPACE_EVENLY', 'SPACE_AROUND', 'SPACE_BETWEEN'.
                id: dimmer_slider
                radius: 10
                bg_color: color_gray
                align: CENTER
                width: 160
                height: 30
                min_value: 30
                max_value: 100
                indicator:
                  bg_color: color_amber
                  radius: 10
                knob:
                  bg_opa: TRANSP
                on_release:
                  then:
                    - light.turn_on:
                        id: backlight
                        brightness: !lambda "return x/100.0;"
                              
########################################################################################                              
                              
            - label:
                grid_cell_column_pos: 1 # place the widget in
                grid_cell_row_pos: 1 # the corresponding cell
                grid_cell_x_align: SPACE_AROUND   #'START', 'CENTER', 'END', 'STRETCH', 'SPACE_EVENLY', 'SPACE_AROUND', 'SPACE_BETWEEN'.
                grid_cell_y_align: CENTER   #'START', 'CENTER', 'END', 'STRETCH', 'SPACE_EVENLY', 'SPACE_AROUND', 'SPACE_BETWEEN'.
                align: LEFT_MID
                text_font: roboto24
                text_color: color_amber
                text: "Сон (сек)"
                
            - roller:
                id: display_timeout_roller
                bg_opa: TRANSP
                border_opa: TRANSP
                shadow_opa: TRANSP
                pad_all: 0
                grid_cell_column_pos: 2 # place the widget in
                grid_cell_row_pos: 1 # the corresponding cell
                grid_cell_x_align: SPACE_AROUND   #'START', 'CENTER', 'END', 'STRETCH', 'SPACE_EVENLY', 'SPACE_AROUND', 'SPACE_BETWEEN'.
                grid_cell_y_align: CENTER   #'START', 'CENTER', 'END', 'STRETCH', 'SPACE_EVENLY', 'SPACE_AROUND', 'SPACE_BETWEEN'.
                width: 180
                align: CENTER
                text_font: roboto24
                text_line_space: 4
                selected:
                  bg_opa: TRANSP
                  text_font: roboto24
                  text_color: color_amber
                      #selected_index: !lambda return id(display_timeout_global);
                options:
                  - "30c"    
                  - "45c"   
                  - "60c"
                  - "90c"
                  - "120c"
                  - "180c"
                  - "300c"
                  - "600c"
                visible_row_count: 2
                on_value:
                  then:
                    - select.set_index:
                        id: timeout
                        index: !lambda |-  
                          return x;

########################################################################################                              
                              
            - label:
                grid_cell_column_pos: 1 # place the widget in
                grid_cell_row_pos: 2 # the corresponding cell
                grid_cell_x_align: SPACE_AROUND   #'START', 'CENTER', 'END', 'STRETCH', 'SPACE_EVENLY', 'SPACE_AROUND', 'SPACE_BETWEEN'.
                grid_cell_y_align: CENTER   #'START', 'CENTER', 'END', 'STRETCH', 'SPACE_EVENLY', 'SPACE_AROUND', 'SPACE_BETWEEN'.
                align: LEFT_MID
                text_font: roboto24
                text_color: color_amber
                text: "Угол экрана"
                
            - roller:
                id: display_rotate
                bg_opa: TRANSP
                border_opa: TRANSP
                shadow_opa: TRANSP
                pad_all: 0
                grid_cell_column_pos: 2 # place the widget in
                grid_cell_row_pos: 2 # the corresponding cell
                grid_cell_x_align: SPACE_AROUND   #'START', 'CENTER', 'END', 'STRETCH', 'SPACE_EVENLY', 'SPACE_AROUND', 'SPACE_BETWEEN'.
                grid_cell_y_align: CENTER   #'START', 'CENTER', 'END', 'STRETCH', 'SPACE_EVENLY', 'SPACE_AROUND', 'SPACE_BETWEEN'.
                width: 180
                align: CENTER
                text_font: roboto24
                text_line_space: 4
                selected:
                  bg_opa: TRANSP
                  text_font: roboto24
                  text_color: color_amber
                      #selected_index: !lambda return id(display_timeout_global);
                options:
                  - "0"      
                  - "90"
                  - "180"
                  - "270"
                visible_row_count: 2
                on_value:
                  then:
                    - select.set_index:
                        id: rotate
                        index: !lambda |-  
                          return x;

########################################################################################    
  
            - label:
                grid_cell_column_pos: 1 # place the widget in
                grid_cell_row_pos: 3 # the corresponding cell
                grid_cell_x_align: SPACE_AROUND   #'START', 'CENTER', 'END', 'STRETCH', 'SPACE_EVENLY', 'SPACE_AROUND', 'SPACE_BETWEEN'.
                grid_cell_y_align: CENTER   #'START', 'CENTER', 'END', 'STRETCH', 'SPACE_EVENLY', 'SPACE_AROUND', 'SPACE_BETWEEN'.
                align: LEFT_MID
                text_font: roboto24
                text_color: color_amber
                text:  "Выкл экран"

            - obj:
                bg_opa: TRANSP
                border_opa: TRANSP
                shadow_opa: TRANSP
                pad_all: 0
                grid_cell_column_pos: 2
                grid_cell_row_pos: 3
                grid_cell_x_align: STRETCH
                grid_cell_y_align: STRETCH
                grid_cell_column_span: 1
                grid_cell_row_span: 1
                widgets:
                  - button:
                      bg_color: color_amber
                      align: CENTER
                      width: 60
                      height: 50
                      on_click:
                        - light.toggle:
                            id: backlight  
                        - lvgl.pause:



########################################################################################    
            - label:
                grid_cell_column_pos: 1 # place the widget in
                grid_cell_row_pos: 4 # the corresponding cell
                grid_cell_x_align: SPACE_AROUND   #'START', 'CENTER', 'END', 'STRETCH', 'SPACE_EVENLY', 'SPACE_AROUND', 'SPACE_BETWEEN'.
                grid_cell_y_align: CENTER   #'START', 'CENTER', 'END', 'STRETCH', 'SPACE_EVENLY', 'SPACE_AROUND', 'SPACE_BETWEEN'.
                align: LEFT_MID
                text_font: roboto24
                text_color: color_amber
                text:  "Тренировка экрана"

            - obj:
                bg_opa: TRANSP
                border_opa: TRANSP
                shadow_opa: TRANSP
                pad_all: 0
                grid_cell_column_pos: 2
                grid_cell_row_pos: 4
                grid_cell_x_align: STRETCH
                grid_cell_y_align: STRETCH
                grid_cell_column_span: 1
                grid_cell_row_span: 1
                widgets:
                  - button:
                      bg_color: color_amber
                      align: CENTER
                      width: 60
                      height: 50
                      on_click:
                        - switch.turn_on: switch_antiburn

########################################################################################    

            - label:
                grid_cell_column_pos: 1 # place the widget in
                grid_cell_row_pos: 5 # the corresponding cell
                grid_cell_x_align: SPACE_AROUND   #'START', 'CENTER', 'END', 'STRETCH', 'SPACE_EVENLY', 'SPACE_AROUND', 'SPACE_BETWEEN'.
                grid_cell_y_align: CENTER   #'START', 'CENTER', 'END', 'STRETCH', 'SPACE_EVENLY', 'SPACE_AROUND', 'SPACE_BETWEEN'.
                align: LEFT_MID
                text_font: roboto24
                text_color: color_amber
                text:  "Перезагрузка"

            - obj:
                bg_opa: TRANSP
                border_opa: TRANSP
                shadow_opa: TRANSP
                pad_all: 0
                grid_cell_column_pos: 2
                grid_cell_row_pos: 5
                grid_cell_x_align: STRETCH
                grid_cell_y_align: STRETCH
                grid_cell_column_span: 1
                grid_cell_row_span: 1
                widgets:
                  - button:
                      bg_color: color_amber
                      align: CENTER
                      width: 60
                      height: 50
                      on_click:
                        - button.press: restart_button

########################################################################################    
